<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    <meta name="description" content="BOJIT Projects, tutorials and ramblings.">
    <meta name="keywords" content="BOJIT,Github,James Bennion-Pedley,engineering,
    programming,Raspberry Pi,Linux,C++,MagicQ,lighting,theatre,electronics">

    <!--Author-->
    <meta name="author" content="James B-P">
    

    <!--Open Graph Title + Favicon -->
    <meta property="og:title" content="BOJIT"/>
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
    
    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="BOJIT"/>

    <!--Type page-->
    <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="BOJIT>" />
    
    <!-- Title -->  
    <title>BOJIT - Custom MagicQ Wing</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/w3.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Amatic+SC|Comfortaa|Gloria+Hallelujah|Gochi+Hand|Kalam|Shadows+Into+Light&display=swap" rel="stylesheet">

    <!-- Styles -->
    <style> 
        body {
            margin: 0;
            padding: 0;
        }
        h2 {
            font-family: 'Gloria Hallelujah', cursive;
        }
        h4 {
            font-family: 'Gloria Hallelujah', cursive;
        }
        p {
            font-family: 'Comfortaa', cursive;
        }
        h2.link:hover {
            filter: invert(100%);
        }
        img.blog_panel {
            padding: 0;
            -moz-border-radius: 0px;
            -webkit-border-radius: 0px;
            border-radius: 0px;
            width: 100%;
        }
        .navbar.navbar-default {
            background-image: linear-gradient(rgba(0,0,0,1),rgba(0,0,0,0.6),rgba(0,0,0,0));
            border: 0;
            -webkit-box-shadow: none;
            box-shadow: none;
        }
        @media (max-width: 768px) {
            .navbar.navbar-default {
                background-image: linear-gradient(rgba(255,255,255,1),rgba(255,255,255,1));
            }
        }
        #null {
            font-family: 'Comfortaa', cursive;
            font-family: 'Gloria Hallelujah', cursive;
            font-family: 'Shadows Into Light', cursive;
            font-family: 'Amatic SC', cursive;
            font-family: 'Kalam', cursive;
            font-family: 'Gochi Hand', cursive;
        }
        .tile {
            position: relative;
            text-align: center;
            color: black;
        }
        .text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: .25s ease;
            display: none;
            pointer-events: none;
            font-family: 'Gloria Hallelujah', cursive;
            font-size: calc(6vw * var(--fontMultiplier));
        }
        .blog-item {
            width: var(--desktopWidth);
        }
        @media (max-width: 768px) {
            .text {
                font-size: calc(20vw * var(--fontMultiplier));
            }
            .blog-item {
                width: 100%;
            }   
        }
        img.blog_panel:hover + .text {
            display: block;
        }
    </style>

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-141105755-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-141105755-1');
    </script>
</head>

<body>
    <!-- Menu -->
    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button style="padding:15px" type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <!-- Socials -->
                <div style="padding:10px">
                <ul class="list-inline navbar-left">
                    <li>
                        <a href="https://www.youtube.com/channel/UCR7zc0TblvkjPy9DhAWUkvA" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-youtube-play fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/james-bennion-pedley-bab14a146/" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/BOJIT" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.facebook.com/James.BOJIT" target="_blank">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                        </span>
                        </a>
                    </li>
                    <li>
                        <a href="https://soundcloud.com/james-bojit" target="_blank">
                        <span class="fa-stack fa-lg">
                            <i class="fa fa-circle fa-stack-2x"></i>
                            <i class="fa fa-soundcloud fa-stack-1x fa-inverse"></i>
                        </span>
                        </a>
                    </li>
                </ul>
                </div>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    <li>
                        <a href="/projects">Projects</a>
                    </li>
                    <li>
                        <a href="/tutorials">Tutorials</a>
                    </li>
                    <li>
                        <a href="/about">About</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Main Content -->

    <!-- Page Header -->
    <!-- Set your background image for this header in the theme's configuration: index_cover -->
    <header class="intro-header" style="background-image: url('/img/BannerSmall.jpg');padding:0px">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="w3-center w3-padding-32">
                        <br>
                        <br>
                        <br>
                        <img src="/img/BOJIT_Logo_Alias_Small.png" placeholder="BOJIT"></img>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="w3-container w3-center">
        <h2 class="heading" style="color:black"><b>CUSTOM MAGICQ WING:</b></h2>
        <h4 class="heading" style="color:gray">25-11-17</h4>
    </div>
    <div class="w3-container">
        <div class="w3-container">
            <p>
                For most of my lighting programming, I use a program called 
                <a href="https://chamsyslighting.com/pages/magicq-downloads" target="_blank">MagicQ</a>. It is very powerful software, 
                and you can get 64 universes of DMX out over Artnet for free. The software that you can download from their website is 
                exactly the same as the software that runs on their consoles, the only difference is the hardware. Their consoles are 
                great for busking in clubs and festivals, but for school shows I could not really justify hiring one in. Chamsys do sell
                hardware wings to work with the PC software, but the free version also has a useful tool for creating keyboard macros.<br>
                I had our school 'Battle of the Bands' competition coming up, so decided to DIY the wing to give myself a bit more control
                over the show than a keyboard would provide. While the outcome is quite quirky and relies on using virtually every key in
                the standard HID library, making typing somewhat tricky, it gets a surprising amount of use, and I can be much less precious
                about this creation than I would be with an MQ60 console.
            </p>
            <div class="w3-container blog-item" style="margin:auto;--desktopWidth:50%">
                <img src="img/Wing.JPG" placeholder="Wing" width="100%">
            </div>
            <p>
                The core of this project was the Arduino Pro Micro. This small board uses the ATMega32u4 chip, which unlike the ATMega328p
                used on the Arduino Uno and the Nano has an integrated USB core. This means that in contrast to using an onboard USB->Serial
                converter, the ATMega can communicate directly over USB, so can act as an HID device. By using this board I was able to map
                all the keys on my wing to 'physical' keys, meaning I do not have to use any software like AutoHotkey.<br>
                Obviously, the number of pins on the Pro Micro is insufficient for the number of switches on the wing, so I used 
                74HC595 shift registers to multiplex the keys as a grid, much like a regular computer keyboard.
                For the keys I used the cheapest mechanical keys I could find on EBay, and wired the entire matrix point-to-point without
                a PCB. Below you can see the mess that that resulted in, but the construction has been surprisingly reliable so far...
            </p>
            <div class="w3-container blog-item" style="margin:auto;--desktopWidth:50%">
                <img src="img/Wiring.JPG" placeholder="Wiring" width="100%">
            </div>
            <p>
                In the picture above you may also notice the other Arduino Nano hanging precariously on a piece of breadboard. This 
                was a bit of an experiment in adding Encoder support to my Wing. While MagicQ macros don't really allow for absolute value
                automation (playback faders, grandmaster, etc...), incremental movements are possible by setting one macro to turn the encoder
                one turn clockwise, and another to turn it clockwise. The Arduino Nano essentially monitors state changes on all 8 encoders, 
                then forwards HID values over serial to the Arduino Pro Micro, which subsequently turns them into keyboard commands. This
                approach is very finnicky, and does not allow encoder velocity control, but the X and Y encoders are just about usable for
                moving head Pan and Tilt control.<br>For the heart of the controller, I decided to try one of those PCB fabrication services
                online, and the ordered boards vastly simplified the building and debugging of this project.
            </p>
            <div class="w3-container blog-item" style="margin:auto;--desktopWidth:50%">
                <img src="img/Multiplexer.JPG" placeholder="Multiplexer" width="100%">
            </div>
            <p>
                I did this project quite a while ago, while I was still quite new to C++, so the code is not very efficient, but I have
                attached the project sketch <a href="./MQ_Wing.ino" download>here</a>, which could be used as a starting point. Unfortunately MagicQ does not allow the use of the
                extended USB HID library so all the macros have to be set onto keys that are used for typing and programming. It is therefore
                advisable to create a button in MagicQ that toggles macros on and off.<br>
                While this DIY wing is not a substitute for a real desk, it makes a very handy extra set of buttons that can be used for macros.
                To use it to run a show, I have to change the way I program shows: With no faders as intensity masters, I have to re-map many of
                the playback keys to control crossfades and change between intensity presets. This makes busking quite difficult, but given enough
                time to program, I can control quite large,complex shows. Below is a picture of the pre-programming/visualisation for our 'Battle of the Bands'
                competition, along with a picture of the performance below that. One feature that is invaluable to have as a physical is the 
                'Preload Cue' button. This feature, paired with the homemade wing, allows me to program in a 'look' from my various stacks, then 
                trigger them with a single button. Even on the high-end consoles this feature is only operable with a soft-button on the touchscreen.
            <div class="w3-container blog-item" style="margin:auto;--desktopWidth:50%">
                <img src="img/Plot.jpg" placeholder="Plot" width="100%">
            </div>
            <p>
                As a quick disclaimer, I am not advocating 'exploiting' MagicQ in this way. Chamsys very generously make the software free to use,
                and they fund this with sales of their hardware. I would highly encourage buying/renting their hardware for large shows, as this 
                is what allows them to keep the software free. However, a project like this is very good for getting a deeper understanding of USB HID,
                and can be used on a slightly smaller scale to add functionality to the Chamsys desks that was not there previously. I do have future plans
                to make a version 2.0, but this wing still covers all the shows that I have to deal with in a school theatre.
            </p>
            <div class="w3-container blog-item" style="margin:auto;--desktopWidth:50%">
                <img src="img/In_Concert.jpg" placeholder="In Concert" width="100%">
            </div>

        </div>
    </div>

    <!-- Footer -->
    <hr />

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://www.youtube.com/channel/UCR7zc0TblvkjPy9DhAWUkvA" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-youtube-play fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.linkedin.com/in/james-bennion-pedley-bab14a146/" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/BOJIT" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.facebook.com/James.BOJIT" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://soundcloud.com/james-bojit" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-soundcloud fa-stack-1x fa-inverse"></i>
                            </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <!-- After footer scripts -->
    
    <!-- Tiler -->
    <script src="js/display.js"></script>
    
    <!-- jQuery -->
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

    <!-- Bootstrap -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Gallery -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>